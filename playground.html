<html>
<head>
<script type="module">
    import  { SlashDBClient } from './modules/slashdbclient.js';
    import { fetchWrapper } from './modules/fetchwrapper.js';
    import { QueryBuilder, eq, any, between, gte, lte, not, and, desc } from './modules/querybuilder.js';


    // create an SDB client and login
    const sdb1 = new SlashDBClient('http://192.168.1.16:8000', 'admin', 'gez0bk949rhwpcjdxqqsn8w9g4iec709');
    sdb1.login();
    console.log('Logged in status: ', await sdb1.isAuthenticated())
    
    // get some config info etc from the connected host
    console.log('Settings --');
    console.log(await sdb1.getSettings().then(r => r[0]));
    console.log('Version --');
    console.log(await sdb1.getVersion().then(r => r['version'][0]));
    console.log('Load model taskdatadb --');
    console.log(await sdb1.loadModel('taskdatadb').then(r => r[0]));
    console.log('Unload model taskdatadb --');
    console.log(await sdb1.unloadModel('taskdatadb').then(r => r[0]));
    console.log('User details for user taskapp -- ')
    console.log(await sdb1.getUser('taskapp').then(r => r[0]));
    console.log('Reflect Status for Chinook --');
    console.log(await sdb1.getReflectStatus('Chinook').then(r => r[0]));
    console.log('DB definition for Chinook --');
    console.log(await sdb1.getDbDef('Chinook').then(r => r[0]));
    console.log('Query definition for add-new-customer --');
    console.log(await sdb1.getQueryDef('add-new-customer').then(r => r[0]));
    
    // create a data discovery object and run a query
    console.log('\n Data discovery query');
    let dd1 = sdb1.dataDiscoveryFactory('Chinook')

    let q1 = new QueryBuilder("Customer").addFilter(any('FirstName','J*,H*')).addFilter(eq('Country','USA')).sort('FirstName',desc('LastName'))
    console.log(q1.str())

    let r = await dd1.get(q1.str() )
    r[0].then(d => console.log(d))

</script>

</head>
<body>
hello world
</body>
</html>